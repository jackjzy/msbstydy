<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.back.mapper.FfwyReportMapper">
    
    <resultMap type="FfwyReport" id="FfwyReportResult">
        <result property="reportId"    column="report_id"    />
        <result property="userId"    column="user_id"    />
        <result property="phone"    column="phone"    />
        <result property="typeId"    column="type_id"    />
        <result property="userName"    column="user_name"    />
        <result property="reportUserId"    column="report_user_id"    />
        <result property="reportUserName"    column="report_user_name"    />
        <result property="reportContent"    column="report_content"    />
        <result property="reply"    column="reply"    />
        <result property="replyStatus"    column="reply_status"    />
        <association property="ffwyReportType" javaType="FfwyReportType">
            <result property="reportTypeId" column="type_id"></result>
            <result property="typeName" column="type_name"></result>
        </association>
    </resultMap>

    <sql id="selectFfwyReportVo">
        select report_id, user_id, phone, type_id, user_name, report_user_id, report_user_name, report_content from ffwy_report
    </sql>

    <sql id="SELECT_REPORT">
                select report_id, user_id, phone, type_id, user_name, report_user_id, report_user_name,
                report_content,type_name,reply,reply_status
				from ffwy_report fr LEFT JOIN ffwy_report_type frt on fr.type_id =frt.report_type_id
    </sql>
    <select id="selectFfwyReportList" parameterType="FfwyReport" resultMap="FfwyReportResult">
        <include refid="SELECT_REPORT"/>
        <where>  
            <if test="userId != null "> and user_id = #{userId}</if>
            <if test="typeId != null "> and type_id = #{typeId}</if>
            <if test="reportUserId != null "> and report_user_id = #{reportUserId}</if>
            <if test="reportContent != null  and reportContent != ''"> and report_content = #{reportContent}</if>
            <if test="reply != null  and reply != ''"> and reply = #{reply}</if>
            <if test="replyStatus != null  and replyStatus != ''"> and reply_status = #{replyStatus}</if>
            <if test="searchStr!=null and searchStr!=''">
                AND
                CONCAT(phone,user_name,report_user_name) LIKE CONCAT ('%', #{searchStr},'%')
            </if>
        </where>
    </select>
    
    <select id="selectFfwyReportById" parameterType="Long" resultMap="FfwyReportResult">
        <include refid="SELECT_REPORT"/>
        where report_id = #{reportId}
    </select>
        
    <insert id="insertFfwyReport" parameterType="FfwyReport" useGeneratedKeys="true" keyProperty="reportId">
        insert into ffwy_report
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="userId != null">user_id,</if>
            <if test="phone != null">phone,</if>
            <if test="typeId != null">type_id,</if>
            <if test="userName != null">user_name,</if>
            <if test="reportUserId != null">report_user_id,</if>
            <if test="reportUserName != null">report_user_name,</if>
            <if test="reportContent != null">report_content,</if>
            <if test="createTime !=null">create_time,</if>
            <if test="reply != null">reply,</if>
            <if test="replyStatus !=null">reply_status,</if>
            <if test="reportVideo !=null">report_video,</if>
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="userId != null">#{userId},</if>
            <if test="phone != null">#{phone},</if>
            <if test="typeId != null">#{typeId},</if>
            <if test="userName != null">#{userName},</if>
            <if test="reportUserId != null">#{reportUserId},</if>
            <if test="reportUserName != null">#{reportUserName},</if>
            <if test="reportContent != null">#{reportContent},</if>
            <if test="createTime != null">#{createTime},</if>
            <if test="reply != null">#{reply},</if>
            <if test="replyStatus != null">#{replyStatus},</if>
            <if test="reportVideo != null">#{reportVideo},</if>
         </trim>
    </insert>

    <update id="updateFfwyReport" parameterType="FfwyReport">
        update ffwy_report
        <trim prefix="SET" suffixOverrides=",">
            <if test="userId != null">user_id = #{userId},</if>
            <if test="phone != null">phone = #{phone},</if>
            <if test="typeId != null">type_id = #{typeId},</if>
            <if test="userName != null">user_name = #{userName},</if>
            <if test="reply != null">reply = #{reply},</if>
            <if test="replyStatus != null">reply_status = #{replyStatus},</if>
            <if test="reportUserId != null">report_user_id = #{reportUserId},</if>
            <if test="reportUserName != null">report_user_name = #{reportUserName},</if>
            <if test="reportContent != null">report_content = #{reportContent},</if>
            <if test="reportVideo !=null">report_video = #{reportVideo},</if>
        </trim>
        where report_id = #{reportId}
    </update>

    <delete id="deleteFfwyReportById" parameterType="Long">
        delete from ffwy_report where report_id = #{reportId}
    </delete>

    <delete id="deleteFfwyReportByIds" parameterType="String">
        delete from ffwy_report where report_id in 
        <foreach item="reportId" collection="array" open="(" separator="," close=")">
            #{reportId}
        </foreach>
    </delete>
</mapper>